<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sruthi Co PES: nn_regression Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sruthi Co PES
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">nn_regression Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aea3f67f21d46358fe3c1bd1690060f15"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#aea3f67f21d46358fe3c1bd1690060f15">create_datasets</a> (data, features, target, frac=0.5)</td></tr>
<tr class="separator:aea3f67f21d46358fe3c1bd1690060f15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b5a9b723a5584e5a2eec86fff6c6fb4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#a9b5a9b723a5584e5a2eec86fff6c6fb4">normalize</a> (data)</td></tr>
<tr class="separator:a9b5a9b723a5584e5a2eec86fff6c6fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e26d5154e94b7c3da40fa67bb4f40f3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#a2e26d5154e94b7c3da40fa67bb4f40f3">build_model</a> (normalizer, layers, input_dim=2, activation='relu', optimizer='adam', loss='mean_squared_error')</td></tr>
<tr class="separator:a2e26d5154e94b7c3da40fa67bb4f40f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2a366f1c82dc4d585dd1c4be5b7081"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#aed2a366f1c82dc4d585dd1c4be5b7081">learning_curve</a> (losses, ax=plt.gca(), log=False, y=&quot;Loss&quot;, title=&quot;Learning curve and convergence time&quot;)</td></tr>
<tr class="separator:aed2a366f1c82dc4d585dd1c4be5b7081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a524c7439cb436db4f3ba780f9e4eeba7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#a524c7439cb436db4f3ba780f9e4eeba7">convergence_time</a> (losses)</td></tr>
<tr class="separator:a524c7439cb436db4f3ba780f9e4eeba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72d507790e1a67912ae3a2bd56a1943"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenn__regression.html#ab72d507790e1a67912ae3a2bd56a1943">retransform</a> (data, predicted_target, target_keys=[&quot;Barrier&quot;])</td></tr>
<tr class="separator:ab72d507790e1a67912ae3a2bd56a1943"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acfc45d24e172f25530e370273822746b"><td class="memItemLeft" align="right" valign="top"><a id="acfc45d24e172f25530e370273822746b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>data</b> = pash_to_dataframe(&quot;data/pash/large_pash.dat&quot;)</td></tr>
<tr class="separator:acfc45d24e172f25530e370273822746b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db469f8446812910ff59a7e4d920f44"><td class="memItemLeft" align="right" valign="top"><a id="a9db469f8446812910ff59a7e4d920f44"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>frac</b></td></tr>
<tr class="separator:a9db469f8446812910ff59a7e4d920f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33f9185dbddf8b7e86f4e061cbfee650"><td class="memItemLeft" align="right" valign="top"><a id="a33f9185dbddf8b7e86f4e061cbfee650"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>normalizer</b> = <a class="el" href="namespacenn__regression.html#a9b5a9b723a5584e5a2eec86fff6c6fb4">normalize</a>(train_features)</td></tr>
<tr class="separator:a33f9185dbddf8b7e86f4e061cbfee650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b8117ba0fe65b30415c1178189bb54d"><td class="memItemLeft" align="right" valign="top"><a id="a3b8117ba0fe65b30415c1178189bb54d"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>model</b> = <a class="el" href="namespacenn__regression.html#a2e26d5154e94b7c3da40fa67bb4f40f3">build_model</a>(normalizer, [150, 150, 150], optimizer=&quot;adamax&quot;)</td></tr>
<tr class="separator:a3b8117ba0fe65b30415c1178189bb54d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d87687986e09459e38906423d8ce6c"><td class="memItemLeft" align="right" valign="top"><a id="ad8d87687986e09459e38906423d8ce6c"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>losses</b> = model.fit(train_features, train_labels, epochs=1000).history['loss']</td></tr>
<tr class="separator:ad8d87687986e09459e38906423d8ce6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab4a73135331645e4eaa3078f97a5cf"><td class="memItemLeft" align="right" valign="top"><a id="abab4a73135331645e4eaa3078f97a5cf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>y</b></td></tr>
<tr class="separator:abab4a73135331645e4eaa3078f97a5cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbac3571bb59f821ba7e48343d3cc97"><td class="memItemLeft" align="right" valign="top"><a id="a3bbac3571bb59f821ba7e48343d3cc97"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>log</b></td></tr>
<tr class="separator:a3bbac3571bb59f821ba7e48343d3cc97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions to manipulate DataFrames for a keras fit, to build models quickly and work on the learning curves
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a2e26d5154e94b7c3da40fa67bb4f40f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e26d5154e94b7c3da40fa67bb4f40f3">&#9670;&nbsp;</a></span>build_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.build_model </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalizer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input_dim</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>activation</em> = <code>'relu'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optimizer</em> = <code>'adam'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>loss</em> = <code>'mean_squared_error'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a normalizer adapted to input, the form of neural network, the dimension of input
and the choice of activation function, optimizer and loss function.
Returns a compiled keras model.
:param normalizer: (keras normalizer object) normalizer
:param layers: (int list) [m,n,..] meaning a first hidden layer with m neurones, a second with n neurones, etc.
:param input_dim: (int) number of features
:param activation: (str) neuron's activation function
:param optimizer: (str) optimizer used to compile
:return model: (keras model) compiled model
</pre> 
</div>
</div>
<a id="a524c7439cb436db4f3ba780f9e4eeba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a524c7439cb436db4f3ba780f9e4eeba7">&#9670;&nbsp;</a></span>convergence_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.convergence_time </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>losses</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a list of losses and returns the start epoch from which the loss has been smaller or equal to the
mean loss at the end for at least 10 epochs or simply returns the last epoch.
Considers that the epochs range from (0, len(losses)).
:param losses: (float list) History.history['loss'] from output of a fit
</pre> 
</div>
</div>
<a id="aea3f67f21d46358fe3c1bd1690060f15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3f67f21d46358fe3c1bd1690060f15">&#9670;&nbsp;</a></span>create_datasets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.create_datasets </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>frac</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes full DataFrame directly transformed from a pash.dat file
and keys of interest to return training and testing datasets.
:param data: (pandas DataFrame) DataFrame of a pash.dat file
:param features: (str list) keys of features
:param target: (str) key of target
:param frac: (float) fraction of the data turned into training set - half by default
:return train_data: (pandas DataFrames) training set with columns corresponding to features and target
:return test_data: (pandas DataFrames) test set with columns corresponding to features and target
:return train_features: (pandas DataFrames) training set with columns corresponding to features
:return train_target: (pandas DataFrames) training set with column corresponding to target
:return test_features: (pandas DataFrames) test set with columns corresponding to features
:return test_target: (pandas DataFrames) test set with column corresponding to target
</pre> 
</div>
</div>
<a id="aed2a366f1c82dc4d585dd1c4be5b7081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2a366f1c82dc4d585dd1c4be5b7081">&#9670;&nbsp;</a></span>learning_curve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.learning_curve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>losses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ax</em> = <code>plt.gca()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>log</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em> = <code>&quot;Loss&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>title</em> = <code>&quot;Learning&#160;curve&#160;and&#160;convergence&#160;time&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes the list of losses and plots it as a function of epochs with a vertical line at convergence.
:param losses: (float list) History.history['loss'] from output of a fit
:param ax: (axes) plt.gca() by default
:param log: (bool) If True the plot is in log scale
:param title: (str) Title of the plot
</pre> 
</div>
</div>
<a id="a9b5a9b723a5584e5a2eec86fff6c6fb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b5a9b723a5584e5a2eec86fff6c6fb4">&#9670;&nbsp;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.normalize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a DataFrame and returns an adapted Keras normalizer.
:param data: (pandas DataFrame) features DataFrame to normalize
:return normalizer: (keras normalizer object) normalizer
</pre> 
</div>
</div>
<a id="ab72d507790e1a67912ae3a2bd56a1943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72d507790e1a67912ae3a2bd56a1943">&#9670;&nbsp;</a></span>retransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def nn_regression.retransform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>predicted_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_keys</em> = <code>[&quot;Barrier&quot;]</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Takes a DataFrame and a single-columned DataFrame added to the former with the given key.
:param data: (pandas DataFrame) DataFrame to be modified
:param predicted_target: (pandas DataFrame) DataFrame with values to be added to data
:param target_keys: (str list) key of column to be added
:return retransformed_data: (pandas DataFrame) DataFrame after concatenation of column
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
